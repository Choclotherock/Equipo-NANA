V.1.0.2
import serial
import wave
import time
import struct

puerto = serial.Serial('COM4', 115200)
time.sleep(2)

sample_rate = 22050
duracion = 5  # segundos
num_muestras = sample_rate * duracion

datos = bytearray()

print("Grabando...")

while len(datos) < num_muestras * 2:  # 2 bytes por muestra
    if puerto.in_waiting >= 2:
        datos.append(puerto.read()[0])  # LSB
        datos.append(puerto.read()[0])  # MSB

print("Grabaci√≥n terminada.")
puerto.close()

# Guardar como archivo .wav de 16 bits
with wave.open("guitarra_16bit.wav", "wb") as wav_file:
    wav_file.setnchannels(1)         # Mono
    wav_file.setsampwidth(2)         # 16 bits
    wav_file.setframerate(sample_rate)
    wav_file.writeframes(datos)

print("Archivo guardado como guitarra_16bit.wav")
